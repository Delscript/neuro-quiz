<!DOCTYPE html>
<html>
<body>
    <h1>TESTE DE CONEX√ÉO</h1>
    <p>Abra este site, clique no bot√£o e me diga o que aparece.</p>
    
    <button onclick="testar()" style="padding:20px; font-size:20px;">TESTAR GERAR PIX</button>
    <div id="log" style="margin-top:20px; border:1px solid #ccc; padding:10px;"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // --- COLOQUE SUAS CHAVES AQUI ---
        const SB_URL = 'https://oabcppkojfmmmqhevjpq.supabase.co'; 
        const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hYmNwcGtvamZtbW1xaGV2anBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAzMTE2ODEsImV4cCI6MjA4NTg4NzY4MX0.b2OlaVmawuwC34kXhLwbJMm6hnPsO7Hng0r8_AHjwhw'; 
        // -------------------------------

        async function testar() {
            const log = document.getElementById('log');
            log.innerHTML = "Iniciando teste...<br>";
            
            if(!SB_URL || !SB_KEY) return log.innerHTML += "‚ùå ERRO: Chaves n√£o configuradas no c√≥digo HTML.<br>";

            try {
                const supabase = window.supabase.createClient(SB_URL, SB_KEY);
                log.innerHTML += "‚úÖ Supabase Conectado.<br>Tentando chamar a Edge Function...<br>";

                const { data, error } = await supabase.functions.invoke('gerar-pix', {
                    body: { email: 'teste@teste.com', valor: 1.00 }
                });

                if (error) {
                    log.innerHTML += `‚ùå ERRO NA FUN√á√ÉO: ${JSON.stringify(error)}<br>`;
                    console.error(error);
                } else if (data.erro) {
                    log.innerHTML += `‚ùå ERRO DO SERVIDOR: ${data.erro}<br>`;
                } else {
                    log.innerHTML += `üéâ SUCESSO! Pix Gerado.<br>C√≥digo: ${data.code.substring(0, 20)}...<br>`;
                    log.innerHTML += `<img src="${data.img}" style="width:100px"><br>`;
                }

            } catch (e) {
                log.innerHTML += `‚ùå ERRO CR√çTICO: ${e.message}<br>`;
            }
        }
    </script>
</body>
</html>
