<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rio Oficial - SierComp4ny</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Allura&family=Inter:wght@400;600;800&family=Playfair+Display:ital,wght@0,700;1,400&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: white; margin: 0; padding: 0; }
        .assinatura { font-family: 'Allura', cursive; font-size: 1.8rem; color: #60a5fa; }
        .serif { font-family: 'Playfair Display', serif; }
        /* AJUSTE PARA EVITAR SOBRA DE P√ÅGINA */
        #area-relatorio { 
            background-color: #020617 !important; 
            width: 794px; /* Largura A4 */
            height: 1120px; /* Altura A4 ligeiramente menor para evitar quebra */
            margin: 0 auto; 
            padding: 40px;
            box-sizing: border-box;
            position: relative;
        }
        .no-print { display: flex; justify-content: center; margin-top: 20px; margin-bottom: 40px; }
    </style>
</head>
<body class="min-h-screen">

    <div id="area-relatorio">
        <div class="flex justify-between items-start mb-10 border-b border-slate-800 pb-6">
            <div>
                <h1 class="text-2xl font-black tracking-widest text-blue-500">SIERCOMP4NY</h1>
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mt-1">
                    Intelligence & <span class="text-orange-500 font-bold text-xs">Sier Growth</span>
                </p>
            </div>
            <div class="text-right">
                <p class="text-[10px] opacity-60 uppercase tracking-widest">Relat√≥rio Confidencial</p>
                <p id="data-hoje" class="text-[11px] font-mono text-slate-400">--/--/----</p>
            </div>
        </div>

        <div class="text-center mb-10">
            <span class="bg-blue-900/40 text-blue-400 text-[10px] font-bold px-4 py-1 rounded-full border border-blue-500/30 uppercase tracking-widest">Resultado da An√°lise</span>
            <h2 id="titulo-perfil" class="text-4xl font-black text-white mt-6 mb-2 uppercase tracking-tight">---</h2>
            <p id="subtitulo-perfil" class="text-blue-400 italic text-lg serif">---</p>
        </div>

        <div class="flex justify-center gap-8 mb-12">
            <div class="bg-slate-900/50 border border-slate-800 p-6 rounded-3xl text-center w-32">
                <p class="text-[10px] text-slate-500 uppercase font-bold mb-2">Raz√£o (QI)</p>
                <div class="text-4xl font-black text-blue-500"><span id="score-qi">0</span><span class="text-sm text-slate-700">/10</span></div>
            </div>
            <div class="bg-slate-900/50 border border-slate-800 p-6 rounded-3xl text-center w-32">
                <p class="text-[10px] text-slate-500 uppercase font-bold mb-2">Emo√ß√£o (QE)</p>
                <div class="text-4xl font-black text-purple-500"><span id="score-qe">0</span><span class="text-sm text-slate-700">/10</span></div>
            </div>
        </div>

        <div class="space-y-8 mb-12 px-4">
            <div class="flex gap-4">
                <span class="text-3xl">üëÅÔ∏è</span>
                <div>
                    <h3 class="font-bold text-base text-white uppercase tracking-wide">O que ningu√©m v√™ em voc√™</h3>
                    <p id="texto-analise" class="text-[13px] text-slate-400 leading-relaxed mt-2 text-justify">---</p>
                </div>
            </div>
            <div class="flex gap-4">
                <span class="text-3xl">üöÄ</span>
                <div>
                    <h3 class="font-bold text-base text-white uppercase tracking-wide">Seu Potencial M√°ximo</h3>
                    <p id="texto-potencial" class="text-[13px] text-slate-400 leading-relaxed mt-2 text-justify">---</p>
                </div>
            </div>
            <div class="bg-blue-600/10 border-l-4 border-orange-500 p-5 rounded-r-2xl">
                <h3 class="font-bold text-blue-400 text-xs mb-2 uppercase tracking-widest flex items-center">
                    <span class="mr-2">‚ö°</span> Sua A√ß√£o Imediata
                </h3>
                <p id="texto-acao" class="text-sm text-blue-100 italic serif">---</p>
            </div>
        </div>

        <div class="absolute bottom-10 left-0 w-full text-center px-10">
            <div class="border-t border-slate-800 pt-8">
                <p class="text-[10px] text-slate-600 uppercase tracking-[0.3em] mb-2">Certificamos a an√°lise de:</p>
                <h4 id="nome-cliente" class="text-3xl font-bold text-white mb-8 capitalize">---</h4>
                
                <div class="flex flex-col items-center">
                    <div class="assinatura">Anderson Dias</div>
                    <div class="h-px w-40 bg-slate-700 my-2"></div>
                    <p class="text-[9px] text-slate-500 uppercase tracking-widest font-semibold">
                        Dias Anderson ‚Ä¢ Founder & Lead Developer Sier Growth
                    </p>
                    <p class="text-[9px] font-mono text-slate-700 mt-2">ID: <span id="txid-display">---</span></p>
                </div>
            </div>
        </div>
    </div>

    <div class="no-print">
        <button onclick="baixarRelatorio()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-12 rounded-full shadow-2xl transition-all active:scale-95">
            üì• BAIXAR RELAT√ìRIO COMPLETO
        </button>
    </div>

    <script>
        const SUPABASE_URL = "https://oabcppkojfmmmqhevjpq.supabase.co"; 
        const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hYmNwcGtvamZtbW1xaGV2anBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAzMTE2ODEsImV4cCI6MjA4NTg4NzY4MX0.b2OlaVmawuwC34kXhLwbJMm6hnPsO7Hng0r8_AHjwhw"; 

        const PERFIS = {
            "Pot√™ncia Expansiva": { 
                titulo: "O Vision√°rio", 
                sub: "Equil√≠brio raro entre Raz√£o e Emo√ß√£o.", 
                analise: "Voc√™ tem a capacidade rara de processar dados frios sem perder o tato humano. Onde a maioria v√™ problemas isolados, voc√™ enxerga o sistema inteiro. Seu c√©rebro funciona como um radar que detecta oportunidades invis√≠veis para mentes comuns.", 
                potencial: "Pense em Steve Jobs: ele n√£o vendia apenas computadores (L√≥gica), vendia sonhos e status (Emo√ß√£o). Voc√™ tem esse mesmo potencial de unir o √∫til ao desej√°vel.", 
                acao: "Pare de fazer o operacional. Sua mente vale ouro na estrat√©gia. Delegue as tarefas repetitivas hoje mesmo." 
            },
            "Executor Solit√°rio": { 
                titulo: "O Estrategista", 
                sub: "Alta precis√£o l√≥gica, foco implac√°vel.", 
                analise: "Sua mente √© uma m√°quina de resolver problemas. Voc√™ disseca desafios complexos com frieza cir√∫rgica. Por√©m, tende a carregar o mundo nas costas porque 'ningu√©m faz t√£o bem quanto voc√™'.", 
                potencial: "Seu caminho √© a lideran√ßa t√©cnica ou a consultoria de alto n√≠vel. Voc√™ enxerga a falha no plano antes de todos.", 
                acao: "Treine um bra√ßo direito imediatamente. Voc√™ est√° limitando seu crescimento ao centralizar tudo." 
            },
            "Conector Nato": { 
                titulo: "O Diplomata", 
                sub: "Intelig√™ncia social acima da m√©dia.", 
                analise: "Voc√™ l√™ ambientes e pessoas como quem l√™ um livro. Sua for√ßa est√° na influ√™ncia e na venda de ideias. O desafio √© que voc√™, √†s vezes, evita conflitos necess√°rios para manter a harmonia.", 
                potencial: "Grandes negociadores e l√≠deres de cultura corporativa t√™m esse perfil. Voc√™ move montanhas atrav√©s das pessoas.", 
                acao: "Use ferramentas de gest√£o (CRM/Agenda). Sua carisma abre portas, mas a falta de processo pode fech√°-las." 
            },
            "Em Constru√ß√£o": { 
                titulo: "Explorador", 
                sub: "Fase de Transi√ß√£o e Recalibragem.", 
                analise: "Sua intelig√™ncia detectou inconsist√™ncias produtivas. Voc√™ est√° em um momento de recalibragem interna, absorvendo novos conhecimentos antes de uma grande mudan√ßa.", 
                potencial: "Seu potencial √© vasto, mas precisa de direcionamento e foco real em autoconhecimento.", 
                acao: "Tente novamente com foco total na sua dor principal hoje. N√£o se disperse em m√∫ltiplas tarefas." 
            }
        };

        async function init() {
            try {
                const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                const params = new URLSearchParams(window.location.search);
                const txid = params.get('txid');
                if (!txid) return;

                const { data, error } = await supabase.from('leads').select('*').eq('txid', txid).single();
                if (data) {
                    document.getElementById('nome-cliente').innerText = data.nome;
                    document.getElementById('score-qi').innerText = data.qi_score || 0;
                    document.getElementById('score-qe').innerText = data.qe_score || 0;
                    document.getElementById('txid-display').innerText = txid.slice(0, 8).toUpperCase();
                    document.getElementById('data-hoje').innerText = new Date().toLocaleDateString('pt-BR');

                    const qi = data.qi_score || 0;
                    const qe = data.qe_score || 0;
                    let p = (qi > 6 && qe > 6) ? "Pot√™ncia Expansiva" : (qi > 6) ? "Executor Solit√°rio" : (qe > 6) ? "Conector Nato" : "Em Constru√ß√£o";

                    const txt = PERFIS[p];
                    document.getElementById('titulo-perfil').innerText = txt.titulo;
                    document.getElementById('subtitulo-perfil').innerText = txt.sub;
                    document.getElementById('texto-analise').innerText = txt.analise;
                    document.getElementById('texto-potencial').innerText = txt.potencial;
                    document.getElementById('texto-acao').innerText = txt.acao;
                }
            } catch (err) { console.error(err); }
        }

        function baixarRelatorio() {
            const element = document.getElementById('area-relatorio');
            const opt = {
                margin: 0,
                filename: 'Relatorio_NeuroQuiz_Sier.pdf',
                image: { type: 'jpeg', quality: 1 },
                html2canvas: { scale: 2, useCORS: true, backgroundColor: '#020617' },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(element).save();
        }
        init();
    </script>
</body>
</html>
