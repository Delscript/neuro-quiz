   <!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificado Oficial - NeuroQuiz</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --cor-sier: #2563eb; --fundo: #0f172a; }
        body { font-family: 'Segoe UI', sans-serif; background: #1e293b; margin: 0; padding: 20px; color: white; display: flex; flex-direction: column; align-items: center; }
        
       function gerarPDF(){

const elemento = document.getElementById("relatorio");

const clone = elemento.cloneNode(true);


// REMOVE LIMITES VISUAIS

clone.style.maxWidth = "210mm";
clone.style.width = "210mm";

clone.style.height = "297mm";

clone.style.margin = "0";
clone.style.padding = "0";

clone.style.position = "fixed";
clone.style.top = "0";
clone.style.left = "0";

clone.style.background = "white";
clone.style.zIndex = "-9999";


document.body.appendChild(clone);



const opt = {

margin:0,

filename:"Relatorio_SierComp4ny.pdf",

image:{
type:"jpeg",
quality:1
},

html2canvas:{

scale:5,

dpi:300,

letterRendering:true,

useCORS:true,

allowTaint:true,

scrollX:0,
scrollY:0,

windowWidth:794,
windowHeight:1123

},


jsPDF:{

unit:"mm",
format:"a4",
orientation:"portrait",

compress:true

}

};



html2pdf()

.set(opt)
.from(clone)
.save()

.then(()=>{

document.body.removeChild(clone);

});


}


        .sier-logo { font-size: 3rem; font-weight: 800; letter-spacing: -2px; margin-bottom: 10px; }
        .sier-logo span { color: var(--cor-sier); }
        
        h1 { font-size: 3.5rem; margin: 20px 0; text-transform: uppercase; letter-spacing: 5px; }
        .subtitulo { font-size: 1.2rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 3px; }
        
        .nome-usuario { font-size: 4rem; color: var(--cor-sier); margin: 30px 0; font-family: 'Times New Roman', serif; font-style: italic; }
        
        .box-scores { display: flex; justify-content: center; gap: 50px; margin: 40px 0; }
        .score-item { background: rgba(255,255,255,0.05); padding: 20px 40px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .score-val { font-size: 3rem; font-weight: bold; color: white; display: block; }
        .score-label { font-size: 0.9rem; color: #94a3b8; text-transform: uppercase; }

        .fase-info { font-size: 1.5rem; color: #cbd5e1; margin-top: 20px; }
        
        .assinatura { margin-top: 50px; border-top: 1px solid #475569; display: inline-block; padding-top: 10px; width: 300px; }
        
        .selo { position: absolute; bottom: 40px; right: 40px; width: 120px; opacity: 0.8; }

        /* BOT√ÉO FORA DA √ÅREA DE IMPRESS√ÉO */
        .area-botoes { margin-top: 30px; display: flex; gap: 15px; width: 297mm; }
        .btn { flex: 1; padding: 20px; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 1.1rem; transition: 0.3s; }
        .btn-download { background: var(--cor-sier); color: white; }
        .btn-zap { background: #25D366; color: white; }
        
        /* Ajuste para telas pequenas (mobile) para visualiza√ß√£o */
        @media (max-width: 300mm) {
            body { transform: scale(0.35); transform-origin: top center; }
            .area-botoes { transform: scale(1); margin-top: 850px; }
        }
    </style>
</head>
<body>

    <div id="certificado-area">
        <div class="sier-logo">SIER<span>GROWTH</span></div>
        <div class="subtitulo">Certificado de Avalia√ß√£o Neuro-Cognitiva</div>
        
        <h1>CERTIFICADO</h1>
        
        <p class="subtitulo">Certificamos que para os devidos fins de an√°lise de perfil profissional</p>
        <div class="nome-usuario" id="out-nome">Anderson Dias</div>
        
        <div class="box-scores">
            <div class="score-item">
                <span class="score-val" id="out-qi">00</span>
                <span class="score-label">Pontos QI (L√≥gica)</span>
            </div>
            <div class="score-item">
                <span class="score-val" id="out-qe">00</span>
                <span class="score-label">Pontos QE (Emocional)</span>
            </div>
        </div>

        <div class="fase-info">N√≠vel de Atua√ß√£o: <strong id="out-fase" style="color: #2563eb;">...</strong></div>

        <div class="assinatura">
            <div style="font-size: 0.8rem; color: #94a3b8;">SierComp4ny Holding</div>
            <strong>Anderson Dias</strong>
            <div style="font-size: 0.7rem; color: #64748b;">Diretor de Neuromarketing</div>
        </div>

        <div style="position: absolute; bottom: 40px; left: 40px; text-align: left; font-size: 0.7rem; color: #475569;">
            ID Autenticidade: <span id="out-txid">...</span><br>
            Data de Emiss√£o: <span id="out-data">...</span>
        </div>
    </div>

    <div class="area-botoes">
        <button onclick="baixarPDF()" class="btn btn-download">üì• BAIXAR CERTIFICADO PDF</button>
        <button onclick="window.open('https://wa.me/5571999466243')" class="btn btn-zap">üí¨ FALAR COM ANDERSON</button>
    </div>

    <script>
        // 1. PEGA OS DADOS DO TXID NA URL
        const urlParams = new URLSearchParams(window.location.search);
        const txid = urlParams.get('txid');

        async function carregarDados() {
            if(!txid) return alert("Erro: ID n√£o encontrado.");
            
            try {
                // Busca no seu banco os dados desse TXID
                const res = await fetch(`/api/status?txid=${txid}`);
                const data = await res.json();
                
                if (data.status === 'pago' || data.nome) {
                    document.getElementById('out-nome').innerText = data.nome || "Participante";
                    document.getElementById('out-qi').innerText = data.qi_score || "0";
                    document.getElementById('out-qe').innerText = data.qe_score || "0";
                    document.getElementById('out-fase').innerText = data.fase_profissional || "N√£o Informado";
                    document.getElementById('out-txid').innerText = txid;
                    document.getElementById('out-data').innerText = new Date().toLocaleDateString('pt-BR');
                } else {
                    alert("Pagamento n√£o confirmado ou dados n√£o encontrados.");
                }
            } catch (e) {
                console.error("Erro ao carregar certificado:", e);
            }
        }

        // 2. FUN√á√ÉO DE DOWNLOAD PROFISSIONAL
        function baixarPDF() {
            const elemento = document.getElementById('certificado-area');
            const btnDownload = document.querySelector('.btn-download');
            
            // Feedback visual
            btnDownload.innerText = "‚è≥ GERANDO PDF...";
            
            const opcoes = {
                margin: 0,
                filename: `Certificado_NeuroQuiz_${txid}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 3, useCORS: true }, // Escala alta para n√£o pixelar
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'landscape' }
            };

            html2pdf().set(opcoes).from(elemento).save().then(() => {
                btnDownload.innerText = "üì• BAIXAR CERTIFICADO PDF";
            });
        }

        carregarDados();
    </script>
</body>
</html>
    </script>

</body>
</html>
