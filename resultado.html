<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rio Oficial - SierComp4ny</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Allura&family=Inter:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .serif { font-family: 'Playfair Display', serif; }
        .assinatura {
            font-family: 'Allura', cursive;
            font-size: 1.0rem; /* Diminu√≠ um pouco */
            color: #1e3a8a;
            transform: rotate(-2deg);
            margin-bottom: -10px;
        }
        .marca-dagua {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 60px; color: rgba(0,0,0,0.03); font-weight: 900; white-space: nowrap; pointer-events: none;
            z-index: 0;
        }
        .loading-screen { position: fixed; inset: 0; background: #0f172a; z-index: 50; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; }
        
        /* Ajuste fino para impress√£o */
        @media print {
            .no-print { display: none !important; }
            body { background: white; }
            #relatorio { box-shadow: none; margin: 0; width: 105%; }
        }
    </style>
</head>
<body class="p-2 md:p-8 min-h-screen flex justify-center items-start">

    <div id="loading" class="loading-screen">
        <div class="animate-spin rounded-full h-12 w-12 border-t-4 border-orange-500 mb-4"></div>
        <h2 id="msg-loading" class="text-lg font-bold animate-pulse">Gerando Relat√≥rio...</h2>
        <p id="msg-erro" class="text-red-400 mt-4 text-sm hidden"></p>
    </div>

    <div id="relatorio" class="hidden bg-white w-full max-w-3xl shadow-2xl rounded-lg overflow-hidden relative">
        
        <div class="bg-gray-900 text-white p-6 flex justify-between items-start relative z-10">
            <div>
                <h1 class="text-xl font-bold tracking-widest">SIERCOMP4NY</h1>
                <p class="text-[10px] text-gray-400 uppercase tracking-wider mt-1">
                    Intelligence & <span class="text-orange-500 font-bold">Sier Growth</span>
                </p>
            </div>
            <div class="text-right mt-1">
                <p class="text-[9px] opacity-60 uppercase tracking-widest">Relat√≥rio Confidencial</p>
                <p class="text-[10px] font-mono text-gray-400" id="data-hoje">...</p>
            </div>
        </div>

        <div class="p-8 relative">
            <div class="marca-dagua">SIERCOMP4NY</div>

            <div class="text-center mb-6 relative z-10">
                <span class="bg-blue-50 text-blue-900 text-[10px] font-bold px-2 py-1 rounded border border-blue-100 uppercase tracking-wide">Resultado da An√°lise</span>
                <h2 id="titulo-perfil" class="text-3xl font-black text-gray-900 mt-3 mb-1">...</h2>
                <p id="subtitulo-perfil" class="text-md text-gray-500 italic serif">...</p>
            </div>

            <div class="flex justify-center gap-4 mb-8 relative z-10">
                <div class="text-center">
                    <div class="text-[10px] font-bold text-gray-400 uppercase mb-1">Raz√£o (QI)</div>
                    <div class="bg-gray-50 border border-gray-100 rounded-lg p-2 w-24">
                        <span id="score-qi" class="text-2xl font-black text-blue-700">0</span>
                        <span class="text-gray-400 text-xs">/10</span>
                    </div>
                </div>
                <div class="text-center">
                    <div class="text-[10px] font-bold text-gray-400 uppercase mb-1">Emo√ß√£o (QE)</div>
                    <div class="bg-gray-50 border border-gray-100 rounded-lg p-2 w-24">
                        <span id="score-qe" class="text-2xl font-black text-purple-700">0</span>
                        <span class="text-gray-400 text-xs">/10</span>
                    </div>
                </div>
            </div>

            <div class="space-y-6 relative z-10">
                
                <div class="flex gap-3">
                    <div class="text-xl mt-1">üëÅÔ∏è</div>
                    <div>
                        <h3 class="font-bold text-gray-900 text-sm">O que ningu√©m v√™ em voc√™</h3>
                        <p id="texto-analise" class="text-xs text-gray-600 leading-relaxed mt-1 text-justify">
                            ...
                        </p>
                    </div>
                </div>

                <div class="flex gap-3">
                    <div class="text-xl mt-1">üöÄ</div>
                    <div>
                        <h3 class="font-bold text-gray-900 text-sm">Seu Potencial M√°ximo</h3>
                        <p id="texto-potencial" class="text-xs text-gray-600 leading-relaxed mt-1 text-justify">
                            ...
                        </p>
                    </div>
                </div>

                <div class="bg-blue-50 border-l-2 border-orange-500 p-3 rounded-r-lg">
                    <h3 class="font-bold text-blue-900 text-xs mb-1 flex items-center">
                        <span class="mr-2">‚ö°</span> Sua A√ß√£o Imediata
                    </h3>
                    <p id="texto-acao" class="text-xs text-blue-800 italic">
                        ...
                    </p>
                </div>

                <div class="text-center py-2">
                    <p class="text-sm serif italic text-gray-400">‚ÄúA inova√ß√£o distingue um l√≠der de um seguidor.‚Äù</p>
                </div>
            </div>

            <div class="mt-8 pt-6 border-t border-gray-100 relative z-10 text-center">
                
                <p class="font-bold text-gray-900 uppercase tracking-[0.2em] text-[10px]">SierComp4ny</p>
                <p class="serif text-lg text-gray-600 mt-1 italic">Certificado de Autoconhecimento</p>
                <p class="text-[10px] font-mono text-gray-300 mt-1 mb-4">ID: <span id="txid-display">...</span></p>
                
                <h1 id="nome-cliente" class="text-3xl font-bold text-blue-900 capitalize mb-8 inline-block border-b border-gray-200 pb-2 px-8">
                    ...
                </h1>

                <div class="flex flex-col items-center justify-center mt-4">
                    <div class="assinatura">Anderson Dias</div>
                    <div class="h-px w-32 bg-gray-400 mt-2 mb-1"></div>
                    <p class="text-[9px] text-gray-400 uppercase mt-0.5">Dias Anderson ‚Ä¢ Founder & Lead Developer Sier Growth</p>
                </div>
            </div>
        </div>
        
        <div class="bg-gradient-to-r from-gray-900 via-blue-900 to-gray-900 h-2 w-full"></div>
    </div>

    <div class="fixed bottom-6 right-6 flex flex-col gap-3 z-50 no-print">
        
        <a href="https://wa.me/5571999466243?text=Ol%C3%A1%2C%20recebi%20meu%20relat%C3%B3rio%20e%20gostaria%20de%20tirar%20d%C3%BAvidas!" target="_blank" class="hidden flex items-center justify-center w-12 h-12 bg-green-500 text-white rounded-full shadow-lg hover:bg-green-600 transition hover:scale-110" id="btn-whatsapp">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/></svg>
        </a>

        <button onclick="gerarPDF()" class="hidden bg-blue-900 hover:bg-black text-white font-bold p-3 rounded-full shadow-xl flex items-center justify-center transition hover:scale-105" id="btn-pdf">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
        </button>
    </div>

    <script>
        // ======================================================
        // ‚ö†Ô∏è COLOQUE SUAS CHAVES AQUI ‚ö†Ô∏è
        const SUPABASE_URL = "https://oabcppkojfmmmqhevjpq.supabase.co"; 
        const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hYmNwcGtvamZtbW1xaGV2anBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAzMTE2ODEsImV4cCI6MjA4NTg4NzY4MX0.b2OlaVmawuwC34kXhLwbJMm6hnPsO7Hng0r8_AHjwhw"; 
        // ======================================================

        // BANCO DE TEXTOS RICOS (Voltei com o conte√∫do completo!)
        const PERFIS = {
            "Pot√™ncia Expansiva": {
                titulo: "O Vision√°rio",
                sub: "Equil√≠brio raro entre Raz√£o e Emo√ß√£o.",
                analise: "Voc√™ tem a capacidade rara de processar dados frios sem perder o tato humano. Onde a maioria v√™ problemas isolados, voc√™ enxerga o sistema inteiro. Seu c√©rebro funciona como um radar que detecta oportunidades invis√≠veis para mentes comuns.",
                potencial: "Pense em Steve Jobs: ele n√£o vendia apenas computadores (L√≥gica), vendia sonhos e status (Emo√ß√£o). Voc√™ tem esse mesmo potencial de unir o √∫til ao desej√°vel.",
                acao: "Pare de fazer o operacional. Sua mente vale ouro na estrat√©gia. Delegue as tarefas repetitivas hoje mesmo."
            },
            "Executor Solit√°rio": {
                titulo: "O Estrategista",
                sub: "Alta precis√£o l√≥gica, foco implac√°vel.",
                analise: "Sua mente √© uma m√°quina de resolver problemas. Voc√™ disseca desafios complexos com frieza cir√∫rgica. Por√©m, tende a carregar o mundo nas costas porque 'ningu√©m faz t√£o bem quanto voc√™'.",
                potencial: "Seu caminho √© a lideran√ßa t√©cnica ou a consultoria de alto n√≠vel. Voc√™ enxerga a falha no plano antes de todos.",
                acao: "Treine um bra√ßo direito imediatamente. Voc√™ est√° limitando seu crescimento ao centralizar tudo."
            },
            "Conector Nato": {
                titulo: "O Diplomata",
                sub: "Intelig√™ncia social acima da m√©dia.",
                analise: "Voc√™ l√™ ambientes e pessoas como quem l√™ um livro. Sua for√ßa est√° na influ√™ncia e na venda de ideias. O desafio √© que voc√™, √†s vezes, evita conflitos necess√°rios para manter a harmonia.",
                potencial: "Grandes negociadores e l√≠deres de cultura corporativa t√™m esse perfil. Voc√™ move montanhas atrav√©s das pessoas.",
                acao: "Use ferramentas de gest√£o (CRM/Agenda). Sua carisma abre portas, mas a falta de processo pode fech√°-las."
            },
             "Em Constru√ß√£o": {
                titulo: "Em An√°lise",
                sub: "Dados inconclusivos.",
                analise: "N√£o foi poss√≠vel determinar um padr√£o claro. O equil√≠brio entre suas respostas sugere um momento de transi√ß√£o ou adapta√ß√£o.",
                potencial: "Seu potencial √© vasto, mas precisa de direcionamento. Foque em autoconhecimento.",
                acao: "Refa√ßa o teste com mais calma."
            }
        };

        async function init() {
            try {
                if (SUPABASE_URL.includes("COLE_SUA")) throw new Error("Configure as chaves no c√≥digo!");

                const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                const params = new URLSearchParams(window.location.search);
                const txid = params.get('txid');

                if (!txid) throw new Error("Link incompleto.");

                const { data, error } = await supabase.from('leads').select('*').eq('txid', txid).single();

                if (error || !data) throw new Error("Relat√≥rio n√£o encontrado.");

                // PREENCHE DADOS
                document.getElementById('nome-cliente').innerText = data.nome || "Cliente VIP";
                document.getElementById('score-qi').innerText = data.qi_score || 0;
                document.getElementById('score-qe').innerText = data.qe_score || 0;
                document.getElementById('txid-display').innerText = txid.slice(0, 8);
                document.getElementById('data-hoje').innerText = new Date(data.created_at).toLocaleDateString('pt-BR');

                // L√≥gica de Perfil
                const qi = data.qi_score || 0;
                const qe = data.qe_score || 0;
                let p = "Conector Nato";
                if (qi > 6 && qe > 6) p = "Pot√™ncia Expansiva";
                else if (qi > 6) p = "Executor Solit√°rio";
                else if (qe > 6) p = "Conector Nato";
                else p = "Em Constru√ß√£o";

                const txt = PERFIS[p];
                document.getElementById('titulo-perfil').innerText = txt.titulo;
                document.getElementById('subtitulo-perfil').innerText = txt.sub;
                document.getElementById('texto-analise').innerText = txt.analise;
                document.getElementById('texto-potencial').innerText = txt.potencial;
                document.getElementById('texto-acao').innerText = txt.acao;

                // Mostra Tela
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('relatorio').classList.remove('hidden');
                document.getElementById('btn-pdf').classList.remove('hidden');
                document.getElementById('btn-whatsapp').classList.remove('hidden');

            } catch (err) {
                document.getElementById('msg-loading').innerText = "Erro ao carregar.";
                const divErro = document.getElementById('msg-erro');
                divErro.innerText = err.message;
                divErro.classList.remove('hidden');
            }
        }

        function gerarPDF() {
            const el = document.getElementById('relatorio');
            const opt = {
                margin: 0,
                filename: 'Relatorio_SierComp4ny.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(el).save();
        }

        init();
    </script>
</body>
</html>
